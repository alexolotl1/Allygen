<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="styles.css">
    <script async
    src="GOOGLE_MAPS_API_KEY">
    </script>
  </head>
  <body>
    <div id="header">
        <div id="logo"> Allygen </div>
        <div id="search-bar">
            <input type="text" id="search-input" placeholder="Search...">
            <button onclick="searchRestaurants()">Search</button>
        </div>
    </div>
  <div id="container">
  <!-- Sidebar filters -->
  <div id="sidebar"> 
    <div class="filter-group">
      <h3 class="filter-title">Categories:</h3>
      <div class="filter-options">
        <label><input type="checkbox" name="category" value="non-gmo"> NON-GMO</label>
        <label><input type="checkbox" name="category" value="vegan"> Vegan</label>
        <label><input type="checkbox" name="category" value="vegetarian"> Vegetarian</label>
      </div>
    </div>
    <div class="filter-group">
      <h3 class="filter-title">Allergies:</h3>
      <div class="filter-options">
        <label><input type="checkbox" name="allergy" value="peanuts"> Peanuts</label>
        <label><input type="checkbox" name="allergy" value="nuts"> Nuts</label>
        <label><input type="checkbox" name="allergy" value="dairy"> Dairy/Gluten</label>
        <label><input type="checkbox" name="allergy" value="eggs"> Eggs</label>
        <label><input type="checkbox" name="allergy" value="milk"> Milk</label>
      </div>
    </div>
  </div>

  <!-- Restaurant list column -->
  <div id="restaurants">
    <div class="restaurant-card">
      <img src="restaurant.jpg" alt="Restaurant photo" class="restaurant-image">
      <div class="restaurant-info">
        <div class="restaurant-header">
          <h2 class="restaurant-name">Green Garden</h2>
          <div class="restaurant-rating">⭐⭐⭐⭐☆</div>
        </div>
        <p class="restaurant-location">Brooklyn, NY</p>
        <div class="restaurant-tags">
          <span class="tag vegan">Vegan</span>
          <span class="tag gluten-free">Gluten-Free</span>
          <span class="tag nut-free">Nut-Free</span>
        </div>
        <p class="restaurant-review">
          “Amazing fresh food, super friendly staff, and great atmosphere!”
        </p>
      </div>
    </div>
  </div>
    <div id="map"> </div>
      <script>
        let map;
        let service;
        let markers=[];

        function initMap() {
          const nyc = new google.maps.LatLng(40.7128, -74.0060);
          map = new google.maps.Map(document.getElementById("map"), {
            center: nyc,
            zoom: 13,
          });
          
          service = new google.maps.places.PlacesService(map);
          searchRestaurants(); // load initial restaurants
        }
        function clearMarkers() {
            markers.forEach(marker => marker.setMap(null));
            markers = [];
        }
        function searchRestaurants() {
          clearMarkers();

          const query = document.getElementById("search-input").value || "restaurant";

          const request = {
            location: map.getCenter(),
            radius: 1000,
            keyword: query,
            type: ["restaurant"]
          };
          service.nearbySearch(request, (results, status) => {
            if (status === google.maps.places.PlacesServiceStatus.OK) {
              results.forEach(place => {
                const marker = new google.maps.Marker({
                  map: map,
                  position: place.geometry.location,
                  title: place.name
                });
                const infowindow = new google.maps.InfoWindow({
                  content: `<b>${place.name}</b><br>${place.vicinity}`
                });
                marker.addListener("click", () => {
                  infowindow.open(map, marker);
                });
                markers.push(marker);
              });
            }
          });
        }
      </script>
    </div>
  </body>
</html>
